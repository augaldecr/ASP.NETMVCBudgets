
@{
    ViewData["Title"] = "Reporte Excel";
    var hoy = DateTime.Today;
    var haceUnMes = hoy.AddMonths(-1);
    var mesActual = hoy.Month;
    var anhoActual = hoy.Year;
    var mesAnterior = haceUnMes.Month;
    var mesAnterioranho = haceUnMes.Year;
    var anhoAnterior = anhoActual - 1;
}

<partial name="_Submenu" Model="SubMenuTransacciones.Excel" />

<h1>Exportar Transacciones a Excel</h1>

<div class="mb-3">
    <a asp-action="ExportarExcelPorMes" asp-route-mes="@mesActual" asp-route-anho="@anhoActual"
    class="btn btn-success"
    >
        Exportar mes actual
    </a> ~ @hoy.ToString("MMMM yyyy")
</div>

<div class="mb-3">
    <a asp-action="ExportarExcelPorMes" asp-route-mes="@mesAnterior" 
    asp-route-anho="@mesAnterioranho"
    class="btn btn-success"
    >
        Exportar mes anterior
    </a> ~ @haceUnMes.ToString("MMMM yyyy")
</div>

<div class="mb-3">
    <a asp-action="ExportarExcelPoranho" asp-route-anho="@anhoActual"
    class="btn btn-success"
    >
        Exportar anho actual
    </a> ~ @anhoActual
</div>

<div class="mb-3">
    <a asp-action="ExportarExcelPoranho" asp-route-anho="@anhoAnterior"
    class="btn btn-success"
    >
        Exportar anho anterior
    </a> ~ @anhoAnterior
</div>

<div class="mb-3">
    <a asp-action="ExportarExcelTodo"
    class="btn btn-success"
    >
        Exportar todo
    </a>
</div>